<%= turbo_stream_from current_group, "properties" %>

<main class="container mb-xxxxl">
  <%= link_to sanitize("&larr; Back to properties"), properties_path %>

  <div class="header">
    <h1>
      <%= @property.name %>
    </h1>
    <div class="property__actions">
      <%= link_to "New",
                  edit_property_path(@property, new_templates: true),
                  data: { turbo_frame: "new_templates" },
                  class: "btn btn--primary" %>   
        
      <%# link_to "New space",
        #          new_property_space_path(@property),
        #          data: { turbo_frame: dom_id(Space.new) },
        #          class: "btn btn--primary" %>   
        
      <%= link_to "See report", 
                  property_path(@property, format: :pdf), 
                  data: { turbo_frame: "_top" },
                  class: "btn btn--light" %>
    </div>
  </div>
    
  <% if @property.spaces.present? %>
    
    <%= turbo_frame_tag "new_templates" %>
    <%= turbo_frame_tag @property do %>
      <%= turbo_frame_tag Space.new %>
      <%= turbo_frame_tag "spaces" do %>
        <%= render @spaces, property: @property %>
      <% end %>
    
      <%= turbo_frame_tag Appliance.new %>
      <%= turbo_frame_tag "appliances" do %>
        <%= render @appliances, property: @property %>
      <% end %>
    <% end %>
  
  <% else %>
    
    <%= turbo_frame_tag @property do %>
      <%= render "properties/banner", property: @property %>  
    <% end %>
    
  <% end %>
    
</main>

<%= turbo_frame_tag dom_id(@property, :total) do %>
    <%= render "properties/total", property: @property %>
<% end %>